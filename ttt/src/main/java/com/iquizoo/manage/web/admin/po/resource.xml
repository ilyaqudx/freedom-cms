<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--Auto Create,Don't Modify,you should copy some sql config,because only have insert,update,full query and delete by primaryKey
	@Author JiangZhiYong	@date 2015年4月21日 11:28:58-->
	
<mapper namespace="Resource">

	<select id="getResourceList"  resultType="Resource">
		SELECT * FROM Resource
	</select>

	<select id="getResourceByPid" parameterType="int" resultType="Resource">
		SELECT * FROM Resource WHERE parentId=#{pId}
	</select>

	<select id="getResourceTableList" parameterType="Map" resultType="Resource">
		SELECT * FROM Resource WHERE 1=1 
		<if test="pId != null">
			and parentId = ${pId}
		</if>
		<if test="order != null">
			order by ${order}
		</if>
		limit #{start},#{length}
	</select>
	
	<select id="getResourceTableListCount" parameterType="Map" resultType="Integer">
		SELECT count(*) FROM Resource WHERE 1=1 
		<if test="pId != null">
			and parentId = ${pId}
		</if>
	</select>

	<select id="getResourceById" parameterType="Integer" resultType="Resource">
		SELECT * FROM Resource WHERE id=#{id}
	</select>
	
	<select id="getResourceByRoleId" parameterType="Integer" resultType="Resource">
		SELECT a.* FROM Resource a left join Roleownresource b ON a.id = b.resourceId WHERE b.roleId=#{roleId}
	</select>
	
	<insert id="addResource" parameterType="Resource">
		INSERT INTO Resource(
		id
		<if test="parentId != null">
			,parentId
		</if>
		<if test="name != null">
			,name
		</if>
		<if test="url != null">
			,url
		</if>
		<if test="status != null">
			,status
		</if>
		<if test="description != null">
			,description
		</if>
		<if test="log != null">
			,log
		</if>
		<if test="authority != null">
			,authority
		</if>
		<if test="icon != null">
			,icon
		</if>
		<if test="type != null">
			,type
		</if>
		)VALUES(
		#{id}
		<if test="parentId != null">
			,#{parentId}
		</if>
		<if test="name != null">
			,#{name}
		</if>
		<if test="url != null">
			,#{url}
		</if>
		<if test="status != null">
			,#{status}
		</if>
		<if test="description != null">
			,#{description}
		</if>
		<if test="log != null">
			,#{log}
		</if>
		<if test="authority != null">
			,#{authority}
		</if>
		<if test="icon != null">
			,#{icon}
		</if>
		<if test="type != null">
			,#{type}
		</if>
		)
	</insert>

	<update id="updateResource" parameterType="Resource">
		UPDATE Resource
		SET 
		id = #{id}
		<if test="parentId != null">
			,parentId = #{parentId}
		</if>
		<if test="name != null">
			,name = #{name}
		</if>
		<if test="url != null">
			,url = #{url}
		</if>
		<if test="status != null">
			,status = #{status}
		</if>
		<if test="description != null">
			,description = #{description}
		</if>
		<if test="log != null">
			,log = #{log}
		</if>
		<if test="authority != null">
			,authority = #{authority}
		</if>
		<if test="icon != null">
			,icon = #{icon}
		</if>
		<if test="type != null">
			,type = #{type}
		</if>
		WHERE 
		id=#{id}
		
	</update>

	<delete id="deleteResourceById" parameterType="Integer">
	    DELETE FROM Resource 
		WHERE 
		id=#{id}
	</delete>

</mapper>