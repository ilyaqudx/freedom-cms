<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--Auto Create,Don't Modify,you should copy some sql config,because only have insert,update,full query and delete by primaryKey
	@Author JiangZhiYong	@date 2015年4月21日 11:28:58-->
	
<mapper namespace="User">

	<select id="getUserList" parameterType="Map" resultType="User">
		SELECT * FROM User WHERE status!=4
		<if test="name != null">
			and name like '%${name}%'
		</if>
		<if test="accountId != null">
			and accountId = #{accountId}
		</if>
		<if test="datemin != null">
			and createTime>=#{datemin}
		</if>
		<if test="datemax != null">
			and #{datemax}>=createTime
		</if>
		<if test="order != null">
			order by ${order}
		</if>
		limit #{start},#{length}
	</select>
	
	<select id="getUserListCount" parameterType="Map" resultType="Integer">
		SELECT count(*) FROM User WHERE status!=4
		<if test="name != null">
			and name like '%${name}%'
		</if>
		<if test="accountId != null">
			and accountId = #{accountId}
		</if>
		<if test="datemin != null">
			and createTime>#{datemin}
		</if>
		<if test="datemax != null">
			and #{datemax}>createTime
		</if>
	</select>
	
	<select id="getDeletedUserList" parameterType="Map" resultType="User">
		SELECT * FROM User WHERE status=4
		<if test="name != null">
			and name like '%${name}%'
		</if>
		<if test="datemin != null">
			and createTime>=#{datemin}
		</if>
		<if test="datemax != null">
			and #{datemax}>=createTime
		</if>
		<if test="order != null">
			order by ${order}
		</if>
		limit #{start},#{length}
	</select>
	
	<select id="getDeletedUserListCount" parameterType="Map" resultType="Integer">
		SELECT count(*) FROM User WHERE status=4
		<if test="name != null">
			and name like '%${name}%'
		</if>
		<if test="datemin != null">
			and createTime>=#{datemin}
		</if>
		<if test="datemax != null">
			and #{datemax}>=createTime
		</if>
	</select>

	<select id="getUserById" parameterType="Integer" resultType="User">
		SELECT * FROM User where id=#{userId}
	</select>
	<select id="getByNameAndAccountId" parameterType="User" resultType="User">
		SELECT * FROM User where accountId=#{accountId} and name = #{name}
	</select>
	<select id="getByAccountId" parameterType="Integer" resultType="User">
		SELECT * FROM `user` WHERE accountId = #{accountId} ORDER BY createTime ASC LIMIT 0,1
	</select>

	<insert id="addUser" parameterType="User">
		INSERT INTO User(
		id
		<if test="name != null">
			,name
		</if>
		<if test="gender != null">
			,gender
		</if>
		<if test="head != null">
			,head
		</if>
		<if test="birthday != null">
			,birthday
		</if>
		<if test="accountId != null">
			,accountId
		</if>
		<if test="admin != null">
			,admin
		</if>
		<if test="type != null">
			,type
		</if>
		<if test="imei != null">
			,imei
		</if>
		<if test="clientId != null">
			,clientId
		</if>
		<if test="deviceToken != null">
			,deviceToken
		</if>
		<if test="createTime != null">
			,createTime
		</if>
		<if test="status != null">
			,status
		</if>
		<if test="novice != null">
			,novice
		</if>
		<if test="phone != null">
			,phone
		</if>
		<if test="password != null">
			,password
		</if>
		<if test="gold != null">
			,gold
		</if>
		<if test="firstPay != null">
			,firstPay
		</if>
		)VALUES(
		#{id}
		<if test="name != null">
			,#{name}
		</if>
		<if test="gender != null">
			,#{gender}
		</if>
		<if test="head != null">
			,#{head}
		</if>
		<if test="birthday != null">
			,#{birthday}
		</if>
		<if test="accountId != null">
			,#{accountId}
		</if>
		<if test="admin != null">
			,#{admin}
		</if>
		<if test="type != null">
			,#{type}
		</if>
		<if test="imei != null">
			,#{imei}
		</if>
		<if test="clientId != null">
			,#{clientId}
		</if>
		<if test="deviceToken != null">
			,#{deviceToken}
		</if>
		<if test="createTime != null">
			,#{createTime}
		</if>
		<if test="status != null">
			,#{status}
		</if>
		<if test="novice != null">
			,#{novice}
		</if>
		<if test="phone != null">
			,#{phone}
		</if>
		<if test="password != null">
			,#{password}
		</if>
		<if test="gold != null">
			,#{gold}
		</if>
		<if test="firstPay != null">
			,#{firstPay}
		</if>
		)
	</insert>

	<update id="updateUser" parameterType="User">
		UPDATE User
		SET 
		id = #{id}
		<if test="name != null">
			,name = #{name}
		</if>
		<if test="gender != null">
			,gender = #{gender}
		</if>
		<if test="head != null">
			,head = #{head}
		</if>
		<if test="birthday != null">
			,birthday = #{birthday}
		</if>
		<if test="accountId != null">
			,accountId = #{accountId}
		</if>
		<if test="admin != null">
			,admin = #{admin}
		</if>
		<if test="type != null">
			,type = #{type}
		</if>
		<if test="imei != null">
			,imei = #{imei}
		</if>
		<if test="clientId != null">
			,clientId = #{clientId}
		</if>
		<if test="deviceToken != null">
			,deviceToken = #{deviceToken}
		</if>
		<if test="createTime != null">
			,createTime = #{createTime}
		</if>
		<if test="status != null">
			,status = #{status}
		</if>
		<if test="novice != null">
			,novice = #{novice}
		</if>
		<if test="phone != null">
			,phone = #{phone}
		</if>
		<if test="password != null">
			,password = #{password}
		</if>
		<if test="gold != null">
			,gold = #{gold}
		</if>
		<if test="firstPay != null">
			,firstPay = #{firstPay}
		</if>
		WHERE 
		id=#{id}
		
	</update>

	<delete id="deleteUserByKey" parameterType="User">
	    DELETE FROM User 
		WHERE 
		id=#{id}
	</delete>
	<select id="getByName" parameterType="String" resultType="User">
	   SELECT * FROM `user` WHERE `name` LIKE '%${name}%'
	</select>
	<select id="getByParams" parameterType="UserDTO" resultType="User">
	   SELECT * FROM `user` WHERE 1 = 1 
	   <if test="name != null">
	   and `name` LIKE '%${name}%'
	   </if>
	   <if test="accountId != null">
	   and accountId = #{accountId}
	   </if>
	   <if test="startTime != null">
	   and createTime >= #{startTime}
	   </if>
	   <if test="endTime != null">
	   and #{endTime} >=#{endTime}
	   </if>
	</select>
	
	<select id="getByCreateTime" resultType="User" parameterType="UserDTO">
	   SELECT * FROM `user` WHERE createTime > #{startTime} AND #{endTime} >= createTime
	</select>
</mapper>